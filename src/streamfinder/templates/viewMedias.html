{% extends "basePage.html" %}
{% block title %} Actors {% endblock %}
{% block content %}

<b><p id="statusText" style="display: none;">{{ status }}</p></b>

<h1>Media</h1>

<div id="mediaList">
  <table id="mediaListTable">
    <tr><th colspan="4">Media</th></tr>
    <tr><th>Name</th><th>Release Year</th><th>Genre</th><th>Director</th></tr>
    {%for media in medias%}
    <tr>
      <td>{{ media.getName() }}</td>
      <td>{{ media.getReleaseYear() }}</td>
      <td>{{ media.getGenre().getName() }}</td>
      <td>{{ media.getDirector().getName() }}</td>
    </tr>
    {%endfor%}
  </table>
</div>

{% if 'userID' in session %}

<div id="addMedia">
  <h2>Add New Media:</h2>

  <form id="mediaForm" method="POST" action="{{ url_for('submitMedia') }}" onsubmit="return submitMedia();">
    <label for="mediaName">Name: </label>
    <input type="text" id="mediaName" name="mediaName" required><br><br>
    <label for="mediaYear">Release Year: </label>
    <input type="text" id="releaseYear" name="mediaYear" required><br><br>
    <label for="mediaGenre">Genre: </label>
    <input type="text" id="mediaGenre" name="mediaGenre" required><br><br>
    <label for="mediaDirector">Director: </label>
    <input type="text" id="mediaDirector" name="mediaDirector" required><br><br>
    <input type="submit" value="Submit">
  </form>

</div>

<script>

  let p = document.getElementById("statusText");
  if (p.innerText !== "") {
    p.style.display = "block";
  }

  function toTitleCase(name) {
    return name.replace(/([^\W_]+[^\s-]*) */g, function (txt) { return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(); });
  }

  function submitMedia() {
    let name = document.forms["mediaForm"]["mediaName"].value.trim();
    name = toTitleCase(name);
    document.forms["mediaForm"]["name"].value = name;
    if (name == "") {
      alert("Name cannot be empty!");
      return false;
    }
  }

</script>

{% endif %}

{% endblock %}